<!-- proximityContext.xml -->
<plexus>
	<components>
		<component>
			<role>org.abstracthorizon.proximity.Proximity</role>
			<role-hint>logic-driven</role-hint>
			<implementation>
				org.abstracthorizon.proximity.impl.LogicDrivenProximityImpl
			</implementation>
			<component-composer>setter</component-composer>
			<requirements>
				<requirement>
					<role>
						org.abstracthorizon.proximity.mapping.GroupRequestMapper
					</role>
					<role-hint>path-based</role-hint>
				</requirement>
				<requirement>
					<role>
						org.abstracthorizon.proximity.logic.ProximityLogic
					</role>
					<role-hint>maven</role-hint>
				</requirement>
				<requirement>
					<role>
						org.abstracthorizon.proximity.Repository
					</role>
					<field-name>repositories</field-name>
				</requirement>
			</requirements>
			<configuration>
				<emerge-groups>true</emerge-groups>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.mapping.GroupRequestMapper
			</role>
			<role-hint>path-based</role-hint>
			<implementation>
				org.abstracthorizon.proximity.mapping.PathBasedGroupRequestMapper
			</implementation>
			<configuration>
<!-- TODO!!!
				<inclusions>
					<public>
						<list>
							<value>
								/com/company/someproject/.*=extNonFree
							</value>
						</list>
					</public>
				</inclusions>
				<exclusions>
					<public>
						<list>
							<value>
								/com/company/someproject/.*=central,extFree
							</value>
							<value>
								/com/company/otherproject/.*=central
							</value>
						</list>
					</public>
				</exclusions>
-->
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.logic.ProximityLogic
			</role>
			<role-hint>maven</role-hint>
			<implementation>
				org.abstracthorizon.proximity.maven.MavenProximityLogic
			</implementation>
		</component>

		<component>
			<role>net.sf.webdav.WebdavStore</role>
			<role-hint>proximity</role-hint>
			<implementation>
				org.abstracthorizon.proximity.webapp.webdav.ProximityWebdavStorageAdapter
			</implementation>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.stats.StatisticsGatherer
			</role>
			<role-hint>simple</role-hint>
			<component-composer>setter</component-composer>
			<implementation>
				org.abstracthorizon.proximity.stats.SimpleStatisticsGathererImpl
			</implementation>
			<requirements>
				<requirement>
					<role>org.abstracthorizon.proximity.Proximity</role>
					<role-hint>logic-driven</role-hint>
				</requirement>
			</requirements>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.access.AccessManager
			</role>
			<role-hint>open</role-hint>
			<implementation>
				org.abstracthorizon.proximity.access.OpenAccessManager
			</implementation>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.access.AccessManager
			</role>
			<role-hint>internal-lan-only</role-hint>
			<implementation>
				org.abstracthorizon.proximity.access.AffirmativeAccessManager
			</implementation>
			<requirements>
				<requirement>
					<role>
						org.abstracthorizon.proximity.access.AccessDecisionVoter
					</role>
					<role-hint>internal-lan-only-ip-voter</role-hint>
				</requirement>
			</requirements>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.access.AccessDecisionVoter
			</role>
			<role-hint>internal-lan-only-ip-voter</role-hint>
			<implementation>
				org.abstracthorizon.proximity.access.IpAddressAccessDecisionVoter
			</implementation>
			<configuration>
				<allowDeny>true</allowDeny>
				<allowFromPattern>192\.168\.0\..*</allowFromPattern>
				<denyFromPattern>.*</denyFromPattern>
			</configuration>
		</component>

		<component>
			<role>org.abstracthorizon.proximity.indexer.Indexer</role>
			<role-hint>lucene</role-hint>
			<component-composer>setter</component-composer>
			<implementation>
				org.abstracthorizon.proximity.indexer.LuceneIndexer
			</implementation>
			<requirements>
				<requirement>
					<role>org.abstracthorizon.proximity.Proximity</role>
					<role-hint>logic-driven</role-hint>
				</requirement>
			</requirements>
			<configuration>
				<indexDirectory>${plexus.home}/index</indexDirectory>
				<recreateIndexes>false</recreateIndexes>
				<dirtyItemTreshold>100</dirtyItemTreshold>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.logic.RepositoryLogic
			</role>
			<role-hint>maven-release</role-hint>
			<implementation>
				org.abstracthorizon.proximity.maven.MavenProxyRepositoryLogic
			</implementation>
			<configuration>
				<snapshotExpirationPeriodInSeconds>
					-1
				</snapshotExpirationPeriodInSeconds>
				<pomExpirationPeriodInSeconds>
					-1
				</pomExpirationPeriodInSeconds>
				<metadataExpirationPeriodInSeconds>
					-1
				</metadataExpirationPeriodInSeconds>
				<itemExpirationPeriodInSeconds>
					-1
				</itemExpirationPeriodInSeconds>
				<shouldServeSnapshots>false</shouldServeSnapshots>
				<shouldServeReleases>true</shouldServeReleases>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.logic.RepositoryLogic
			</role>
			<role-hint>maven-snapshot</role-hint>
			<implementation>
				org.abstracthorizon.proximity.maven.MavenProxyRepositoryLogic
			</implementation>
			<configuration>
				<snapshotExpirationPeriodInSeconds>
					43200
				</snapshotExpirationPeriodInSeconds>
				<pomExpirationPeriodInSeconds>
					43200
				</pomExpirationPeriodInSeconds>
				<metadataExpirationPeriodInSeconds>
					43200
				</metadataExpirationPeriodInSeconds>
				<itemExpirationPeriodInSeconds>
					43200
				</itemExpirationPeriodInSeconds>
				<shouldServeSnapshots>true</shouldServeSnapshots>
				<shouldServeReleases>false</shouldServeReleases>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.metadata.ProxiedItemPropertiesFactory
			</role>
			<role-hint>inspector-list-processing</role-hint>
			<implementation>
				org.abstracthorizon.proximity.metadata.InspectorListProcessingProxiedItemPropertiesFactory
			</implementation>
			<requirements>
				<requirement>
					<role>
						org.abstracthorizon.proximity.metadata.inspectors.ItemInspector
					</role>
					<field-name>itemInspectorList</field-name>
				</requirement>
			</requirements>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.metadata.inspectors.ItemInspector
			</role>
			<role-hint>maven</role-hint>
			<implementation>
				org.abstracthorizon.proximity.maven.MavenItemInspector
			</implementation>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.metadata.inspectors.ItemInspector
			</role>
			<role-hint>zip-file</role-hint>
			<implementation>
				org.abstracthorizon.proximity.metadata.inspectors.ZipFileInspector
			</implementation>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.metadata.inspectors.ItemInspector
			</role>
			<role-hint>jar-file</role-hint>
			<implementation>
				org.abstracthorizon.proximity.metadata.inspectors.JarFileInspector
			</implementation>
		</component>

		<component>
			<role>org.abstracthorizon.proximity.Repository</role>
			<role-hint>central</role-hint>
			<implementation>
				org.abstracthorizon.proximity.impl.LogicDrivenRepositoryImpl
			</implementation>
			<requirements>
				<requirement>
					<role>
						org.abstracthorizon.proximity.storage.local.LocalStorage
					</role>
					<role-hint>central</role-hint>
				</requirement>
				<requirement>
					<role>
						org.abstracthorizon.proximity.storage.remote.RemoteStorage
					</role>
					<role-hint>central</role-hint>
				</requirement>
				<requirement>
					<role>
						org.abstracthorizon.proximity.access.AccessManager
					</role>
					<role-hint>open</role-hint>
				</requirement>
				<requirement>
					<role>
						org.abstracthorizon.proximity.logic.RepositoryLogic
					</role>
					<role-hint>maven-release</role-hint>
				</requirement>
			</requirements>
			<configuration>
				<id>central</id>
				<groupId>public</groupId>
				<rank>50</rank>
				<listable>true</listable>
				<available>true</available>
				<offline>false</offline>
				<indexable>true</indexable>
				<reindexAtInitialize>false</reindexAtInitialize>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.storage.local.LocalStorage
			</role>
			<role-hint>central</role-hint>
			<implementation>
				org.abstracthorizon.proximity.storage.local.WritableFileSystemStorage
			</implementation>
			<requirements>
				<requirement>
					<role>
						org.abstracthorizon.proximity.metadata.ProxiedItemPropertiesFactory
					</role>
					<role-hint>inspector-list-processing</role-hint>
				</requirement>
			</requirements>
			<configuration>
				<metadataAware>true</metadataAware>
				<metadataDirFile>
					${plexus.home}/central/meta
				</metadataDirFile>
				<storageDirFile>
					${plexus.home}/central/data
				</storageDirFile>
			</configuration>
		</component>

		<component>
			<role>
				org.abstracthorizon.proximity.storage.remote.RemoteStorage
			</role>
			<role-hint>central</role-hint>
			<implementation>
				org.abstracthorizon.proximity.storage.remote.CommonsHttpClientRemotePeer
			</implementation>
			<configuration>
				<remoteUrl>http://repo1.maven.org/maven2/</remoteUrl>
				<connectionTimeout>10000</connectionTimeout>
				<retrievalRetryCount>3</retrievalRetryCount>

				<!-- Proxy piping 
					<queryString></queryString>
				-->

				<!-- HTTP proxy stuff
					<proxyHost>myproxyhost.company.com</proxyHost>
					<proxyPort>8080</proxyPort>
					<proxyUsername>userOnProxy (for ntlm without domain prefix)</proxyUsername>
					<proxyPassword>secret</proxyPassword>
					<proxyNtlmDomain>domain to authenticate within</proxyNtlmDomain>
					<proxyNtlmHost>originating hostname</proxyNtlmHost>
				-->
			</configuration>
		</component>
	</components>
</plexus>